<!DOCTYPE html>

<head>
    <title>San Marcos Adoption Center</title>
    <script>
        const URL = 'http://localhost:8000/'

        function setIH(ID, text) {
            var str = "";
            text.forEach(e => {
                str = str + `<button onClick=\"getPetInfo('${e}')\" >${e}</button> <br/>  <button onClick =\"adoptPet('${e}')\" >Adopt ${e}</button><br/> <br/> `
            });
            document.getElementById(ID).innerHTML = str;
            document.getElementById("petDetail").innerHTML = '';
        }

        async function getPetInfo(name) {
            const json = await fetch(URL + name);
            const data = await json.json();

            var str = "";
            str = `Species: ${data.species}<br/>Breed: ${data.breed}<br/>Age: ${data.age}`
            document.getElementById('petDetail').innerHTML = `<p>About ${name}:</p>` + str;
        }

        async function showPets() {
            try {
                let r = await fetch(URL);
                let d = await r.json();

                setIH('pets', d);
            }
            catch (error) {
                console.log('Error fetching pets:', error);
            }
        }

        async function adoptPet(name){
            const json = await fetch(URL + name, {
                method: 'DELETE',
            }).then(res => res.text());

            const r = `<p>${name} has been adopted<p/>`;
            document.getElementById("petDetail").innerHTML = r;
            
        }
    </script>
    <style src="style.css"></style>
</head>

<body>
    <div class="center">
        <h1>San Marcos Adoption Center</h1>
        <hr>
    </div>
    <h2>Available Pets:</h2>
    <p id='pets'></p>
    <p id='petDetail'></p>
    <button onClick="showPets()">Show Pets</button>
    
</body>

</html>
